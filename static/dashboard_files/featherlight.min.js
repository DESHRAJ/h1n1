!function(e){if("undefined"==typeof e){return void ("console" in window&&window.console.info("Too much lightness, Featherlight needs jQuery."))}var d=e.featherlight=function(g,b){if(this.constructor===d){this.id=d.id++}else{if("string"==typeof g||!1!=g instanceof e){var a=(new d).setup(g,b);return a.config.open.call(a),a}b=e.extend({},d.defaults,g||{}),e(b.selector,b.context).featherlight()}},f=function(b){if(27===b.keyCode&&!b.isDefaultPrevented()){var g=d.current();g&&g.config.closeOnEsc&&(g.$instance.find("."+g.config.namespace+"-close:first").click(),b.preventDefault())}};e.extend(d,{id:0,defaults:{autostart:!0,namespace:"featherlight",selector:"[data-featherlight]",context:"body",type:{image:!1,ajax:!1},targetAttr:"data-featherlight",variant:null,resetCss:!1,background:null,openTrigger:"click",closeTrigger:"click",openSpeed:250,closeSpeed:250,closeOnClick:"background",closeOnEsc:!0,closeIcon:"&#10005;",beforeOpen:e.noop,beforeClose:e.noop,afterOpen:e.noop,afterClose:e.noop,contentFilters:["jquery","image","html","ajax"],open:function(g){var c=this.config.beforeOpen.call(this,g);return !1!==c&&(c=this.open(g)),!1!==c&&this.config.afterOpen.call(this,g),c},close:function(g){var c=this.config.beforeClose.call(this,g);!1!==c&&this.close(g)}},methods:{setup:function(j,i){"object"!=typeof j||j instanceof e!=!1||i||(i=j,j=void 0),i=e.extend({},d.defaults,i);var h=i.resetCss?i.namespace+"-reset":i.namespace,b=e(i.background||'<div class="'+h+'"><div class="'+h+'-content"><span class="'+h+"-close-icon "+i.namespace+'-close">'+i.closeIcon+"</span></div></div>"),a=this;return e.extend(a,{config:i,target:j,$instance:b.clone().addClass(i.variant)}),a.$instance.on(i.closeTrigger+"."+i.namespace,function(g){var k=e(g.target);("background"===i.closeOnClick&&k.is("."+i.namespace)||"anywhere"===i.closeOnClick||k.is("."+i.namespace+"-close"))&&(g.preventDefault(),i.close.call(a))}),this},attach:function(a,i,h){var g={};return e.each(a[0].attributes,function(){var j=this.name.match(/^data-featherlight-(.*)/);if(j){var l=this.value;try{l=e.parseJSON(l)}catch(k){}g[e.camelCase(j[1])]=l}}),this.$elm=a,this.setup(i,e.extend(g,h)),a.on(this.config.openTrigger+"."+this.config.namespace,e.proxy(this.config.open,this)),this},getContent:function(){var j,i=this,h=i.target||i.$elm.attr(i.config.targetAttr)||"";for(var b in i.config.type){i.config.type[b]===!0&&(j=d.contentFilters[b])}if(!j&&h in d.contentFilters&&(j=d.contentFilters[h],h=i.target&&i.$elm.attr(i.config.targetAttr)),h=h||i.$elm.attr("href")||"",!j){var a=h;if(h=null,e.each(i.config.contentFilters,function(){return j=d.contentFilters[this],j.test&&(h=j.test(a)),!h&&j.regex&&a.match&&a.match(j.regex)&&(h=a),!h}),!h){return"console" in window&&window.console.error("Featherlight: no content filter found "+(a?' for "'+a+'"':" (no target specified)")),!1}}return j.process.call(i,h)},setContent:function(a){var g=this;(a.is("iframe")||e("iframe",a).length>0)&&g.$instance.addClass(g.config.namespace+"-iframe"),g.$content=a.clone().addClass(g.config.namespace+"-inner"),g.$instance.find("."+g.config.namespace+"-inner").remove(),g.$instance.find("."+g.config.namespace+"-content").append(g.$content)},open:function(c){var b=this;c&&c.preventDefault();var a=this.getContent();return a?(b.constructor._opened.add(b._openedCallback=function(g){b.$instance.closest("body").length>0&&(g.currentFeatherlight=b)}),this.config.closeOnEsc&&f&&(e(document).bind("keyup."+d.defaults.namespace,f),f=null),this.setContent(a),this.$instance.appendTo("body").fadeIn(this.config.openSpeed),void 0):!1},close:function(g){var c=this;c.constructor._opened.remove(c._openedCallback),c.$instance.fadeOut(c.config.closeSpeed,function(){c.$instance.detach(),c.config.afterClose.call(c,g)})}},contentFilters:{jquery:{regex:/^[#.]\w/,test:function(a){return a instanceof e&&a},process:function(a){return e(a)}},image:{regex:/\.(png|jpg|jpeg|gif|tiff|bmp)(\?\S*)?$/i,process:function(a){return e('<img src="'+a+'" alt="" class="'+this.config.namespace+'-image" />')}},html:{regex:/^\s*<[\w!][^<]*>/,process:function(a){return e(a)}},ajax:{regex:/./,process:function(a){var h=this,g=e("<div></div>").load(a,function(c,i){"error"!==i&&e.featherlight(g.html(),e.extend({},h.config,{type:{html:!0}}))})}}},current:function(){var b={};return this._opened.fire(b),b.currentFeatherlight},close:function(){var b=d.current();b&&b.config.close.call(b)},_opened:e.Callbacks()}),d.prototype=e.extend({constructor:d},d.methods),e.fn.featherlight=function(b,a){return this.each(function(){(new d).attach(e(this),a,b)}),this},e(document).ready(function(){var a=d.defaults;a.autostart&&e(a.selector,a.context).featherlight()})}(jQuery);